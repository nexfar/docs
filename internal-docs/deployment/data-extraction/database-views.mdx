---
title: "Acesso via Banco de Dados"
description: "Integra√ß√£o com a Nexfar atrav√©s de VIEWs padronizadas no banco de dados"
---

## Vis√£o Geral

O acesso via banco de dados permite que a Nexfar extraia dados do seu ERP atrav√©s de VIEWs SQL padronizadas. Este √© um dos m√©todos mais perform√°ticos e diretos de integra√ß√£o.

## Requisitos T√©cnicos

### IPs para Libera√ß√£o

Para que a Nexfar possa acessar seu banco de dados, √© necess√°rio liberar os seguintes endere√ßos IP:

<Warning>
  **IPs que devem ser liberados no firewall:**
  - `189.28.42.170`
  - `170.84.19.69`
</Warning>

### Nomenclatura das VIEWs

As views, tabelas ou endpoints devem sempre sinalizar que s√£o destinadas √† integra√ß√£o da Nexfar:

- **VIEW**: Deve se chamar `VIEW_NEXFAR_CLIENT`, `VIEW_NEXFAR_PRODUCT`, etc.
- **Tabela**: Deve se chamar `NEXFAR_CLIENT`, `NEXFAR_PRODUCT`, etc.
- **Endpoint**: Deve se chamar `NEXFAR_CLIENT`, `NEXFAR_PRODUCT`, etc.

## Op√ß√µes de Implementa√ß√£o

### Op√ß√£o 1: VIEWs Diretas

Cria√ß√£o de VIEWs que acessam diretamente as tabelas do ERP.

<Info>
  Esta √© a op√ß√£o mais simples e recomendada quando n√£o h√° restri√ß√µes de acesso direto ao banco de produ√ß√£o.
</Info>

### Op√ß√£o 2: Banco Intermedi√°rio

Caso o cliente opte por disponibilizar um banco intermedi√°rio, as tabelas deste banco devem:

- **Ser incrementais**: Os dados devem ser sempre acrescentados, nunca removidos e inseridos novamente
- **Possuir coluna de auditoria**: Incluir uma coluna que informe a data em que o registro foi inserido ou atualizado

<Note>
  **Views Materializadas**: Caso n√£o seja poss√≠vel realizar uma implementa√ß√£o incremental dos dados, √© fundamental a cria√ß√£o de views materializadas. Recomendamos o uso do PostgreSQL para este cen√°rio.
</Note>

#### Fluxo com Views Materializadas

```sql
-- 1. Apagar os registros da tabela
TRUNCATE TABLE nexfar_client;

-- 2. Repopular a tabela
INSERT INTO nexfar_client SELECT * FROM erp_clients WHERE active = true;

-- 3. Dar refresh na view materializada
REFRESH MATERIALIZED VIEW view_nexfar_client;
```

### Op√ß√£o 3: API REST

Caso o cliente opte por disponibilizar uma API, os endpoints disponibilizados devem permitir o uso de `queryFilters` para todos os campos:

- **VARCHAR**: Opera√ß√µes LIKE
- **DATE/TIMESTAMP**: Intervalos
- **INTEGER**: Operadores `>` e `<`
- **Pagina√ß√£o**: Filtros padr√£o `page` e `pageSize`

## Legendas e Sinaliza√ß√µes

Ao analisar a documenta√ß√£o das VIEWs, voc√™ encontrar√° os seguintes s√≠mbolos:

- **#Ô∏è‚É£** Campos que formam o `hashErp` - a combina√ß√£o deles deve ser √∫nica por registro
- **üîç** Campos frequentemente utilizados para busca - devem ser indexados
- **‚ö†Ô∏è** Campos que n√£o devem ser enviados por padr√£o - tratados via regra do integrador

<Note>
  Nas tabelas de refer√™ncia, as colunas em **verde** sinalizam informa√ß√µes que podem ser compartilhadas com o cliente, enquanto as em **cinza** apresentam informa√ß√µes exclusivamente internas.
</Note>

## VIEWs Dispon√≠veis

As VIEWs est√£o organizadas por categoria para facilitar a implementa√ß√£o:

<CardGroup cols={2}>
  <Card title="Cadastros B√°sicos" icon="users" href="/deployment/data-extraction/views/cadastros-basicos">
    Clientes, Condi√ß√µes de Pagamento, Vendedores e Grupos de Pre√ßo
  </Card>

  <Card title="Produtos" icon="box" href="/deployment/data-extraction/views/produtos">
    Produtos, Filiais, Armaz√©ns, Pre√ßos e Restri√ß√µes
  </Card>

  <Card title="Pedidos" icon="file-invoice" href="/deployment/data-extraction/views/pedidos">
    Cabe√ßalho e Itens de Pedidos (normais e distribuidores)
  </Card>

  <Card title="Vendas" icon="chart-line" href="/deployment/data-extraction/views/vendas">
    Cabe√ßalho, Itens, Clientes e Vendedores de Vendas
  </Card>

  <Card title="Combos" icon="layer-group" href="/deployment/data-extraction/views/combos">
    Cabe√ßalho, Itens, Clientes e Vendedores de Combos
  </Card>

  <Card title="Impostos e Margens" icon="percent" href="/deployment/data-extraction/views/impostos-margens">
    Determina√ß√µes e Valores de Impostos e Margens
  </Card>

  <Card title="Documentos Fiscais" icon="file-lines" href="/deployment/data-extraction/views/documentos-fiscais">
    Notas Fiscais e Documentos Relacionados
  </Card>
</CardGroup>

## Pr√≥ximos Passos

1. Escolha a op√ß√£o de implementa√ß√£o mais adequada (VIEW direta, banco intermedi√°rio ou API)
2. Revise as VIEWs necess√°rias para sua integra√ß√£o
3. Implemente as VIEWs seguindo as especifica√ß√µes de cada categoria
4. Libere os IPs da Nexfar no firewall
5. Entre em contato para valida√ß√£o da integra√ß√£o

<Tip>
  Recomendamos come√ßar pelas VIEWs de **Cadastros B√°sicos** (Cliente e Condi√ß√µes de Pagamento) e depois expandir para as demais categorias.
</Tip>

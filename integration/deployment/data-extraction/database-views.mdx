---
title: "Acesso via Banco de Dados"
description: "Integração com a Nexfar através de VIEWs padronizadas no banco de dados"
---

## Visão Geral

O acesso via banco de dados permite que a Nexfar extraia dados do seu ERP através de VIEWs SQL padronizadas. Este é um dos métodos mais performáticos e diretos de integração.

## Requisitos Técnicos

### Método 1: Conexão via VPN (Recomendado) ⭐

A Nexfar utiliza **Tailscale** (VPN site-to-site) para criar conexões seguras com bancos de dados dos clientes.

**Vantagens:**
- ✅ **Segurança aprimorada**: Criptografia end-to-end automática
- ✅ **Instalação simples**: Comando de uma linha (one-line install)
- ✅ **Flexibilidade**: Funciona de qualquer localização, sem necessidade de IP fixo
- ✅ **Gerenciamento fácil**: Controle de acesso centralizado via ACLs
- ✅ **Sem exposição pública**: Banco de dados não fica exposto na internet

**Instalação Rápida:**

<CodeGroup>
```bash Linux/Unix
curl -fsSL https://raw.githubusercontent.com/nexfar/vpn/main/install.sh | sudo bash
```

```bash Linux/Unix (wget)
wget -qO- https://raw.githubusercontent.com/nexfar/vpn/main/install.sh | sudo bash
```

```powershell Windows (PowerShell)
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/nexfar/vpn/main/install.ps1" -OutFile "$env:TEMP\install.ps1"
& "$env:TEMP\install.ps1"
```
</CodeGroup>

**Informações Necessárias:**
- **Auth Key**: Fornecido pela equipe Nexfar
- **Porta do banco de dados**: Ex: 5432 (PostgreSQL), 3306 (MySQL), 1521 (Oracle)
- **Tipo do banco**: postgres, mysql, oracle, sqlserver, mongodb, etc.

<Tip>
  **Documentação completa da VPN:** [github.com/nexfar/vpn](https://github.com/nexfar/vpn)
</Tip>

---

### Método 2: Liberação de IPs (Alternativo)

Se sua organização preferir conexão direta sem VPN, libere os seguintes IPs no firewall:

<Warning>
  **IPs que devem ser liberados no firewall:**
  - `189.28.42.170`
  - `170.84.19.69`

  ⚠️ **Nota:** Este método requer IP fixo e expõe o banco de dados publicamente. Recomendamos usar VPN para maior segurança.
</Warning>

### Nomenclatura das VIEWs

As views devem sempre sinalizar que são destinadas à integração da Nexfar:

- **VIEW**: Deve se chamar `VIEW_NEXFAR_CLIENT`, `VIEW_NEXFAR_PRODUCT`, etc.

## Opções de Implementação

### Opção 1: VIEWs Diretas

Criação de VIEWs que acessam diretamente as tabelas do ERP.

<Info>
  Esta é a opção mais simples e recomendada quando não há restrições de acesso direto ao banco de produção.
</Info>

### Opção 2: Banco Intermediário

Caso o cliente opte por disponibilizar um banco intermediário, as tabelas deste banco devem:

- **Ser incrementais**: Os dados devem ser sempre acrescentados, nunca removidos e inseridos novamente
- **Possuir coluna de auditoria**: Incluir uma coluna que informe a data em que o registro foi inserido ou atualizado

<Note>
  **Views Materializadas**: Caso não seja possível realizar uma implementação incremental dos dados, é fundamental a criação de views materializadas. Recomendamos o uso do PostgreSQL para este cenário.
</Note>

## VIEWs Disponíveis

As VIEWs estão organizadas por categoria para facilitar a implementação:

<CardGroup cols={2}>
  <Card title="Cadastros Básicos" icon="users" href="/integration/deployment/data-extraction/views/cadastros-basicos">
    Clientes, Condições de Pagamento, Vendedores e Grupos de Preço
  </Card>

  <Card title="Produtos" icon="box" href="/integration/deployment/data-extraction/views/produtos">
    Produtos, Filiais, Armazéns, Preços e Restrições
  </Card>

  <Card title="Pedidos" icon="file-invoice" href="/integration/deployment/data-extraction/views/pedidos">
    Cabeçalho e Itens de Pedidos
  </Card>

  <Card title="Vendas" icon="chart-line" href="/integration/deployment/data-extraction/views/vendas">
    Cabeçalho, Itens, Clientes e Vendedores de Vendas
  </Card>

  <Card title="Combos" icon="layer-group" href="/integration/deployment/data-extraction/views/combos">
    Cabeçalho, Itens, Clientes e Vendedores de Combos
  </Card>

  <Card title="Impostos e Margens" icon="percent" href="/integration/deployment/data-extraction/views/impostos-margens">
    Determinações e Valores de Impostos e Margens
  </Card>

  <Card title="Documentos Fiscais" icon="file-lines" href="/integration/deployment/data-extraction/views/documentos-fiscais">
    Notas Fiscais e Documentos Relacionados
  </Card>
</CardGroup>

## Próximos Passos

1. **Escolha o método de conexão**:
   - **VPN (Recomendado)**: Instale o cliente Tailscale usando os comandos acima
   - **Liberação de IPs**: Configure firewall para permitir acesso dos IPs da Nexfar

2. Escolha a opção de implementação mais adequada (VIEW direta ou banco intermediário)

3. Revise as VIEWs necessárias para sua integração

4. Implemente as VIEWs seguindo as especificações de cada categoria

5. **Configure o acesso**:
   - Se usar VPN: Forneça as informações de conexão (porta, tipo de banco)
   - Se usar IPs: Confirme liberação no firewall

6. Entre em contato para validação da integração

<Tip>
  Recomendamos começar pelas VIEWs de **Cadastros Básicos** (Cliente e Condições de Pagamento) e depois expandir para as demais categorias.
</Tip>
